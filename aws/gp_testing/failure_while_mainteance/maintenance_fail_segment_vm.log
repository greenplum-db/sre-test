nohup: ignoring input
========================Start of test====================
======================start the mainteance script and connect to sdw1 and reboot segment host======================
Traceback (most recent call last):
  File "/usr/local/greenplum-db-6.13.0/bin/gpssh", line 288, in <module>
    main()
  File "/usr/local/greenplum-db-6.13.0/bin/gpssh", line 267, in main
    output = GV.session.executeCommand(GV.argcmd)
  File "/usr/local/greenplum-db-6.13.0/lib/python/gppylib/util/ssh_utils.py", line 282, in executeCommand
    while not s.prompt(120) and s.isalive() and not s.eof(): pass
  File "/usr/local/greenplum-db-6.13.0/bin/lib/pexpect/pxssh.py", line 363, in prompt
    i = self.expect([self.PROMPT, TIMEOUT], timeout=timeout)
  File "/usr/local/greenplum-db-6.13.0/bin/lib/pexpect/__init__.py", line 1448, in expect
    timeout, searchwindowsize)
  File "/usr/local/greenplum-db-6.13.0/bin/lib/pexpect/__init__.py", line 1463, in expect_list
    timeout, searchwindowsize)
  File "/usr/local/greenplum-db-6.13.0/bin/lib/pexpect/__init__.py", line 1551, in expect_loop
    raise EOF(str(err) + '\n' + str(self))
pexpect.EOF: End Of File (EOF). Exception style platform.
<gpssh_modules.gppxssh_wrapper.PxsshWrapper object at 0x7f562643e5d0>
version: 3.3
command: /bin/ssh
args: ['/bin/ssh', '-o', 'BatchMode=yes', '-o', 'StrictHostKeyChecking=no', '-q', '-l', 'gpadmin', 'sdw1_ipv4']
searcher: <pexpect.searcher_re object at 0x7f562643e610>
buffer (last 100 chars): ''
before (last 100 chars): 'sudo reboot\r\nConnection to sdw1_ipv4 closed by remote host.\r\r\n'
after: <class 'pexpect.EOF'>
match: None
match_index: None
exitstatus: 255
flag_eof: True
pid: 18919
child_fd: 3
closed: False
timeout: 30
delimiter: <class 'pexpect.EOF'>
logfile: None
logfile_read: None
logfile_send: None
maxread: 2000
ignorecase: False
searchwindowsize: None
delaybeforesend: 0.05
delayafterclose: 0.1
delayafterterminate: 0.1
=======================check the failed segment====================
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-Starting gpstate with args: 
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-local Greenplum Version: 'postgres (Greenplum Database) 6.13.0 build commit:4f1adf8e247a9685c19ea02bcaddfdc200937ecd'
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-master Greenplum Version: 'PostgreSQL 9.4.24 (Greenplum Database 6.13.0 build commit:4f1adf8e247a9685c19ea02bcaddfdc200937ecd) on x86_64-unknown-linux-gnu, compiled by gcc (GCC) 6.4.0, 64-bit compiled on Dec 16 2020 19:38:24'
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-Obtaining Segment details from master...
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-Gathering data from segments...
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-Greenplum instance status summary
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-----------------------------------------------------
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-   Master instance                                           = Active
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-   Master standby                                            = smdw_ipv4
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-   Standby master state                                      = Standby host passive
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-   Total segment instance count from metadata                = 24
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-----------------------------------------------------
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-   Primary Segment Status
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-----------------------------------------------------
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-   Total primary segments                                    = 12
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-   Total primary segment valid (at master)                   = 9
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[WARNING]:-Total primary segment failures (at master)                = 3                      <<<<<<<<
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[WARNING]:-Total number of postmaster.pid files missing              = 3                      <<<<<<<<
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-   Total number of postmaster.pid files found                = 9
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[WARNING]:-Total number of postmaster.pid PIDs missing               = 3                      <<<<<<<<
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-   Total number of postmaster.pid PIDs found                 = 9
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[WARNING]:-Total number of /tmp lock files missing                   = 3                      <<<<<<<<
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-   Total number of /tmp lock files found                     = 9
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[WARNING]:-Total number postmaster processes missing                 = 3                      <<<<<<<<
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-   Total number postmaster processes found                   = 9
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-----------------------------------------------------
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-   Mirror Segment Status
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-----------------------------------------------------
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-   Total mirror segments                                     = 12
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-   Total mirror segment valid (at master)                    = 9
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[WARNING]:-Total mirror segment failures (at master)                 = 3                      <<<<<<<<
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[WARNING]:-Total number of postmaster.pid files missing              = 3                      <<<<<<<<
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-   Total number of postmaster.pid files found                = 9
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[WARNING]:-Total number of postmaster.pid PIDs missing               = 3                      <<<<<<<<
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-   Total number of postmaster.pid PIDs found                 = 9
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[WARNING]:-Total number of /tmp lock files missing                   = 3                      <<<<<<<<
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-   Total number of /tmp lock files found                     = 9
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[WARNING]:-Total number postmaster processes missing                 = 3                      <<<<<<<<
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-   Total number postmaster processes found                   = 9
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[WARNING]:-Total number mirror segments acting as primary segments   = 3                      <<<<<<<<
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-   Total number mirror segments acting as mirror segments    = 9
20210305:15:40:50:018999 gpstate:mdw_ipv4:gpadmin-[INFO]:-----------------------------------------------------
 dbid | content | role | preferred_role | mode | status | port | hostname  |  address  |          datadir           
------+---------+------+----------------+------+--------+------+-----------+-----------+----------------------------
    2 |       0 | m    | p              | n    | d      | 4000 | sdw1_ipv4 | sdw1_ipv4 | /data1/gpdb/primary/gpseg0
   14 |       0 | p    | m              | n    | u      | 5000 | sdw2_ipv4 | sdw2_ipv4 | /data1/gpdb/mirror/gpseg0
    3 |       1 | m    | p              | n    | d      | 4001 | sdw1_ipv4 | sdw1_ipv4 | /data2/gpdb/primary/gpseg1
   15 |       1 | p    | m              | n    | u      | 5001 | sdw2_ipv4 | sdw2_ipv4 | /data2/gpdb/mirror/gpseg1
    4 |       2 | m    | p              | n    | d      | 4002 | sdw1_ipv4 | sdw1_ipv4 | /data3/gpdb/primary/gpseg2
   16 |       2 | p    | m              | n    | u      | 5002 | sdw2_ipv4 | sdw2_ipv4 | /data3/gpdb/mirror/gpseg2
   23 |       9 | m    | m              | n    | d      | 5000 | sdw1_ipv4 | sdw1_ipv4 | /data1/gpdb/mirror/gpseg9
   25 |      11 | m    | m              | n    | d      | 5002 | sdw1_ipv4 | sdw1_ipv4 | /data3/gpdb/mirror/gpseg11
   24 |      10 | m    | m              | n    | d      | 5001 | sdw1_ipv4 | sdw1_ipv4 | /data2/gpdb/mirror/gpseg10
(9 rows)

========================Recover failed segment incremental==========================
20210305:15:40:50:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Starting gprecoverseg with args: -a
20210305:15:40:50:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-local Greenplum Version: 'postgres (Greenplum Database) 6.13.0 build commit:4f1adf8e247a9685c19ea02bcaddfdc200937ecd'
20210305:15:40:50:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-master Greenplum Version: 'PostgreSQL 9.4.24 (Greenplum Database 6.13.0 build commit:4f1adf8e247a9685c19ea02bcaddfdc200937ecd) on x86_64-unknown-linux-gnu, compiled by gcc (GCC) 6.4.0, 64-bit compiled on Dec 16 2020 19:38:24'
20210305:15:40:50:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Obtaining Segment details from master...
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Heap checksum setting is consistent between master and the segments that are candidates for recoverseg
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Greenplum instance recovery parameters
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Recovery type              = Standard
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Recovery 1 of 6
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Synchronization mode                 = Incremental
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance host                 = sdw1_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance address              = sdw1_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance directory            = /data1/gpdb/primary/gpseg0
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance port                 = 4000
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance host        = sdw2_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance address     = sdw2_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance directory   = /data1/gpdb/mirror/gpseg0
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance port        = 5000
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Target                      = in-place
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Recovery 2 of 6
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Synchronization mode                 = Incremental
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance host                 = sdw1_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance address              = sdw1_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance directory            = /data2/gpdb/primary/gpseg1
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance port                 = 4001
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance host        = sdw2_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance address     = sdw2_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance directory   = /data2/gpdb/mirror/gpseg1
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance port        = 5001
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Target                      = in-place
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Recovery 3 of 6
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Synchronization mode                 = Incremental
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance host                 = sdw1_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance address              = sdw1_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance directory            = /data3/gpdb/primary/gpseg2
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance port                 = 4002
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance host        = sdw2_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance address     = sdw2_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance directory   = /data3/gpdb/mirror/gpseg2
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance port        = 5002
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Target                      = in-place
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Recovery 4 of 6
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Synchronization mode                 = Incremental
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance host                 = sdw1_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance address              = sdw1_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance directory            = /data1/gpdb/mirror/gpseg9
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance port                 = 5000
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance host        = sdw4_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance address     = sdw4_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance directory   = /data1/gpdb/primary/gpseg9
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance port        = 4000
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Target                      = in-place
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Recovery 5 of 6
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Synchronization mode                 = Incremental
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance host                 = sdw1_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance address              = sdw1_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance directory            = /data2/gpdb/mirror/gpseg10
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance port                 = 5001
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance host        = sdw4_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance address     = sdw4_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance directory   = /data2/gpdb/primary/gpseg10
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance port        = 4001
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Target                      = in-place
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Recovery 6 of 6
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Synchronization mode                 = Incremental
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance host                 = sdw1_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance address              = sdw1_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance directory            = /data3/gpdb/mirror/gpseg11
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance port                 = 5002
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance host        = sdw4_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance address     = sdw4_ipv4
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance directory   = /data3/gpdb/primary/gpseg11
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance port        = 4002
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Target                      = in-place
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:40:51:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Starting to modify pg_hba.conf on primary segments to allow replication connections
20210305:15:40:57:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Successfully modified pg_hba.conf on primary segments to allow replication connections
20210305:15:40:57:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-6 segment(s) to recover
20210305:15:40:57:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Ensuring 6 failed segment(s) are stopped
20210305:15:40:58:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Ensuring that shared memory is cleaned up for stopped segments
20210305:15:40:59:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Updating configuration with new mirrors
20210305:15:40:59:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Updating mirrors
20210305:15:40:59:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Running pg_rewind on required mirrors
.....................................................
20210305:15:41:53:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Starting mirrors
20210305:15:41:53:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-era is a9b63a7b265af9ee_210305102527
20210305:15:41:53:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Commencing parallel segment instance startup, please wait...
.......
20210305:15:42:00:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Process results...
20210305:15:42:00:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Triggering FTS probe
20210305:15:42:00:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-******************************************************************
20210305:15:42:00:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Updating segments for streaming is completed.
20210305:15:42:00:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-For segments updated successfully, streaming will continue in the background.
20210305:15:42:00:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Use  gpstate -s  to check the streaming progress.
20210305:15:42:00:019077 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-******************************************************************
================================Check if all segments are up and go ahead to rebalance===========================
 dbid | content | role | preferred_role | mode | status | port | hostname  |  address  |          datadir           
------+---------+------+----------------+------+--------+------+-----------+-----------+----------------------------
   16 |       2 | p    | m              | s    | u      | 5002 | sdw2_ipv4 | sdw2_ipv4 | /data3/gpdb/mirror/gpseg2
    4 |       2 | m    | p              | s    | u      | 4002 | sdw1_ipv4 | sdw1_ipv4 | /data3/gpdb/primary/gpseg2
   14 |       0 | p    | m              | s    | u      | 5000 | sdw2_ipv4 | sdw2_ipv4 | /data1/gpdb/mirror/gpseg0
    2 |       0 | m    | p              | s    | u      | 4000 | sdw1_ipv4 | sdw1_ipv4 | /data1/gpdb/primary/gpseg0
   15 |       1 | p    | m              | s    | u      | 5001 | sdw2_ipv4 | sdw2_ipv4 | /data2/gpdb/mirror/gpseg1
    3 |       1 | m    | p              | s    | u      | 4001 | sdw1_ipv4 | sdw1_ipv4 | /data2/gpdb/primary/gpseg1
(6 rows)

20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Starting gprecoverseg with args: -ar
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-local Greenplum Version: 'postgres (Greenplum Database) 6.13.0 build commit:4f1adf8e247a9685c19ea02bcaddfdc200937ecd'
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-master Greenplum Version: 'PostgreSQL 9.4.24 (Greenplum Database 6.13.0 build commit:4f1adf8e247a9685c19ea02bcaddfdc200937ecd) on x86_64-unknown-linux-gnu, compiled by gcc (GCC) 6.4.0, 64-bit compiled on Dec 16 2020 19:38:24'
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Obtaining Segment details from master...
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Greenplum instance recovery parameters
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Recovery type              = Rebalance
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Unbalanced segment 1 of 6
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance host        = sdw2_ipv4
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance address     = sdw2_ipv4
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance directory   = /data1/gpdb/mirror/gpseg0
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance port        = 5000
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Balanced role                   = Mirror
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Current role                    = Primary
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Unbalanced segment 2 of 6
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance host        = sdw1_ipv4
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance address     = sdw1_ipv4
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance directory   = /data1/gpdb/primary/gpseg0
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance port        = 4000
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Balanced role                   = Primary
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Current role                    = Mirror
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Unbalanced segment 3 of 6
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance host        = sdw2_ipv4
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance address     = sdw2_ipv4
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance directory   = /data2/gpdb/mirror/gpseg1
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance port        = 5001
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Balanced role                   = Mirror
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Current role                    = Primary
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Unbalanced segment 4 of 6
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance host        = sdw1_ipv4
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance address     = sdw1_ipv4
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance directory   = /data2/gpdb/primary/gpseg1
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance port        = 4001
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Balanced role                   = Primary
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Current role                    = Mirror
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Unbalanced segment 5 of 6
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance host        = sdw2_ipv4
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance address     = sdw2_ipv4
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance directory   = /data3/gpdb/mirror/gpseg2
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance port        = 5002
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Balanced role                   = Mirror
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Current role                    = Primary
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Unbalanced segment 6 of 6
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance host        = sdw1_ipv4
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance address     = sdw1_ipv4
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance directory   = /data3/gpdb/primary/gpseg2
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Unbalanced instance port        = 4002
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Balanced role                   = Primary
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Current role                    = Mirror
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Getting unbalanced segments
20210305:15:43:40:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Stopping unbalanced primary segments...
20210305:15:43:41:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Triggering segment reconfiguration
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Starting segment synchronization
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-=============================START ANOTHER RECOVER=========================================
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-local Greenplum Version: 'postgres (Greenplum Database) 6.13.0 build commit:4f1adf8e247a9685c19ea02bcaddfdc200937ecd'
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-master Greenplum Version: 'PostgreSQL 9.4.24 (Greenplum Database 6.13.0 build commit:4f1adf8e247a9685c19ea02bcaddfdc200937ecd) on x86_64-unknown-linux-gnu, compiled by gcc (GCC) 6.4.0, 64-bit compiled on Dec 16 2020 19:38:24'
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Obtaining Segment details from master...
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Heap checksum setting is consistent between master and the segments that are candidates for recoverseg
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Greenplum instance recovery parameters
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Recovery type              = Standard
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Recovery 1 of 3
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Synchronization mode                 = Incremental
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance host                 = sdw2_ipv4
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance address              = sdw2_ipv4
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance directory            = /data1/gpdb/mirror/gpseg0
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance port                 = 5000
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance host        = sdw1_ipv4
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance address     = sdw1_ipv4
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance directory   = /data1/gpdb/primary/gpseg0
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance port        = 4000
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Target                      = in-place
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Recovery 2 of 3
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Synchronization mode                 = Incremental
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance host                 = sdw2_ipv4
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance address              = sdw2_ipv4
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance directory            = /data2/gpdb/mirror/gpseg1
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance port                 = 5001
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance host        = sdw1_ipv4
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance address     = sdw1_ipv4
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance directory   = /data2/gpdb/primary/gpseg1
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance port        = 4001
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Target                      = in-place
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Recovery 3 of 3
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Synchronization mode                 = Incremental
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance host                 = sdw2_ipv4
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance address              = sdw2_ipv4
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance directory            = /data3/gpdb/mirror/gpseg2
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Failed instance port                 = 5002
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance host        = sdw1_ipv4
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance address     = sdw1_ipv4
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance directory   = /data3/gpdb/primary/gpseg2
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Source instance port        = 4002
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-   Recovery Target                      = in-place
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:----------------------------------------------------------
20210305:15:43:49:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Starting to modify pg_hba.conf on primary segments to allow replication connections
20210305:15:43:55:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Successfully modified pg_hba.conf on primary segments to allow replication connections
20210305:15:43:55:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-3 segment(s) to recover
20210305:15:43:55:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Ensuring 3 failed segment(s) are stopped
20210305:15:43:56:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Ensuring that shared memory is cleaned up for stopped segments
20210305:15:43:56:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Updating configuration with new mirrors
20210305:15:43:56:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Updating mirrors
20210305:15:43:56:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Running pg_rewind on required mirrors
20210305:15:44:12:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Starting mirrors
20210305:15:44:12:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-era is a9b63a7b265af9ee_210305102527
20210305:15:44:12:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Commencing parallel segment instance startup, please wait...
20210305:15:44:12:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Process results...
20210305:15:44:12:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Triggering FTS probe
20210305:15:44:13:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-******************************************************************
20210305:15:44:13:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Updating segments for streaming is completed.
20210305:15:44:13:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-For segments updated successfully, streaming will continue in the background.
20210305:15:44:13:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Use  gpstate -s  to check the streaming progress.
20210305:15:44:13:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-******************************************************************
20210305:15:44:13:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-==============================END ANOTHER RECOVER==========================================
20210305:15:44:13:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-******************************************************************
20210305:15:44:13:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-The rebalance operation has completed successfully.
20210305:15:44:13:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-There is a resynchronization running in the background to bring all
20210305:15:44:13:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-segments in sync.
20210305:15:44:13:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-Use gpstate -e to check the resynchronization progress.
20210305:15:44:13:019365 gprecoverseg:mdw_ipv4:gpadmin-[INFO]:-******************************************************************
================End of test================
 dbid | content | role | preferred_role | mode | status | port | hostname  |  address  |          datadir          
------+---------+------+----------------+------+--------+------+-----------+-----------+---------------------------
   15 |       1 | m    | m              | n    | d      | 5001 | sdw2_ipv4 | sdw2_ipv4 | /data2/gpdb/mirror/gpseg1
(1 row)

NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause. Creating a NULL policy entry.
ERROR:  relation "tab1" already exists
  count  | gp_segment_id 
---------+---------------
 8333177 |             4
 8336696 |             0
 8333233 |             5
 8330221 |            10
 8332847 |             1
 8335810 |             6
 8337047 |             3
 8335024 |             9
 8332577 |             7
 8334089 |            11
 8332583 |             2
 8326696 |             8
(12 rows)

DROP TABLE
